1. Code Explanation (Line-by-Line)
General Settings
apache
Copy
Edit
ServerTokens Prod
Hides Apache version details in HTTP response headers (Server:). Shows only Apache.

apache
Copy
Edit
ServerSignature Off
Disables the footer signature on error pages.

apache
Copy
Edit
Timeout 60
Sets request/response timeout to 60 seconds.

apache
Copy
Edit
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5
Enables persistent connections for performance.

Allows up to 100 requests per connection.

Idle keep-alive connections close after 5 seconds.

Load Required Modules
apache
Copy
Edit
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule ssl_module modules/mod_ssl.so
LoadModule headers_module modules/mod_headers.so
LoadModule deflate_module modules/mod_deflate.so
LoadModule cache_module modules/mod_cache.so
LoadModule cache_disk_module modules/mod_cache_disk.so
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule ratelimit_module modules/mod_ratelimit.so
Loads modules for reverse proxying, HTTPS, HTTP headers, compression, caching, rewriting URLs, and rate-limiting.

SSL Virtual Host
apache
Copy
Edit
Listen 443 https
<VirtualHost *:443>
    ServerName localhost
Listens on port 443 for HTTPS traffic.

Sets the hostname to localhost.

apache
Copy
Edit
    SSLEngine on
    SSLCertificateFile "/etc/httpd/certs/nginx-selfsigned.crt"
    SSLCertificateKeyFile "/etc/httpd/certs/nginx-selfsigned.key"
Enables SSL and specifies certificate and key paths.

Security Headers
apache
Copy
Edit
    Header always set X-Frame-Options "DENY"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
Adds protection against clickjacking, MIME sniffing, XSS attacks, and enforces HTTPS for 1 year.

Compression
apache
Copy
Edit
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/json application/javascript
Compresses common text-based content for faster delivery.

Caching
apache
Copy
Edit
    CacheQuickHandler on
    CacheLock on
    CacheEnable disk "/api/"
    CacheRoot "/var/cache/httpd"
    CacheDefaultExpire 60
Enables disk caching for /api/ responses for 60 seconds.

Rate Limiting
apache
Copy
Edit
    SetOutputFilter RATE_LIMIT
    SetEnv rate-limit 512
Limits bandwidth per request to roughly 512 bytes/ms (~512 KB/sec).

Reverse Proxy
apache
Copy
Edit
    ProxyPreserveHost On
    ProxyPass /api/ http://127.0.0.1:3001/
    ProxyPassReverse /api/ http://127.0.0.1:3001/
Forwards /api/ requests to a backend service running on port 3001.

apache
Copy
Edit
    ProxyPass / http://127.0.0.1:3001/
    ProxyPassReverse / http://127.0.0.1:3001/
Forwards all other traffic to the same backend.

Custom Error Pages
apache
Copy
Edit
    ErrorDocument 404 /custom_404.html
    ErrorDocument 500 /custom_50x.html
    DocumentRoot "/var/www/errors"
Uses custom error pages stored in /var/www/errors.

HTTP to HTTPS Redirect
apache
Copy
Edit
<VirtualHost *:80>
    ServerName localhost
    Redirect "/" "https://localhost/"
</VirtualHost>
Redirects all HTTP traffic to HTTPS.

2. Folder & File Structure
Example structure based on your config:

bash
Copy
Edit
/etc/httpd/
├── conf/httpd.conf               # Main Apache config (could include your snippet)
├── certs/
│   ├── nginx-selfsigned.crt       # SSL certificate
│   └── nginx-selfsigned.key       # SSL private key
/var/www/errors/
│   ├── custom_404.html
│   └── custom_50x.html
/var/cache/httpd/                  # Cache storage for mod_cache_disk
3. Installation & Setup Steps
Install Apache and Modules
On CentOS/RHEL:

bash
Copy
Edit
sudo yum install httpd mod_ssl
On Ubuntu/Debian:

bash
Copy
Edit
sudo apt install apache2 apache2-utils
sudo a2enmod ssl proxy proxy_http headers deflate cache cache_disk rewrite ratelimit
Create Certificates
bash
Copy
Edit
sudo mkdir -p /etc/httpd/certs
sudo openssl req -x509 -nodes -days 365 \
  -newkey rsa:2048 \
  -keyout /etc/httpd/certs/nginx-selfsigned.key \
  -out /etc/httpd/certs/nginx-selfsigned.crt
Place Config
Save your config to /etc/httpd/conf.d/reverse-proxy.conf (CentOS) or /etc/apache2/sites-available/reverse-proxy.conf (Debian).

Enable the site on Debian:

bash
Copy
Edit
sudo a2ensite reverse-proxy
Set Permissions
bash
Copy
Edit
sudo mkdir -p /var/www/errors
sudo chown -R apache:apache /var/www/errors /var/cache/httpd
Restart Apache
bash
Copy
Edit
sudo systemctl restart httpd    # CentOS
sudo systemctl restart apache2  # Ubuntu
4. Key Features Enabled by This Config
HTTPS with self-signed SSL for encryption.

Reverse proxy to backend service (Node.js, Python, etc.) at port 3001.

Security hardening with headers and hidden server info.

Gzip compression for performance.

Disk-based caching for /api/ responses.

Rate limiting to prevent bandwidth abuse.

Custom error pages for better UX.

HTTP → HTTPS redirect for secure default access.
